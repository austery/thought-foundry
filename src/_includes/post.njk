---
layout: "base.njk"
---

<div class="report-container">
    
  <aside id="toc-container" class="sidebar-toc"></aside>
  
  <main id="content-body" class="main-content" data-page-title="{{ title }}" lang="zh-CN" {% if not exclude %}data-pagefind-body{% else %}data-pagefind-ignore{% endif %}>

    <div id="top"></div>

    {# Pagefind metadata for search indexing #}
    {% if not exclude %}
      <span data-pagefind-meta="title" style="display:none;">{{ title }}</span>
      {% if speaker %}<span data-pagefind-meta="speaker" style="display:none;">{{ speaker }}</span>{% endif %}
      {% if guest %}<span data-pagefind-meta="guest" style="display:none;">{{ guest }}</span>{% endif %}
      {% if date %}
        <span data-pagefind-meta="date" style="display:none;">
          {% if date.toLocaleDateString %}{{ date.toLocaleDateString() }}{% else %}{{ date }}{% endif %}
        </span>
      {% endif %}
    {% endif %}
    
    {# ------------------- å…ƒæ•°æ®å—ä»£ç å¼€å§‹ ------------------- #}

    <div class="metadata-block">
      {# PKM åˆ†ç±»æ³• (v7.4) - æ˜¾ç¤ºåœ¨æœ€é¡¶éƒ¨ #}
      {% if area or category or (project and project.length > 0) %}
        <div class="pkm-taxonomy">
          {% if area %}
            <p><strong>é¢†åŸŸ:</strong>
              {# [OPTIMIZATION] Use getAreaSlug helper #}
              <a class="taxonomy-link" href="{{ ('/areas/' + (area | getAreaSlug(collections)) + '/') | url }}">{{ area }}</a>
            </p>
          {% endif %}
          {% if category %}
            <p><strong>åˆ†ç±»:</strong>
              {# [OPTIMIZATION] Use getCategorySlug helper #}
              <a class="taxonomy-link" href="{{ ('/categories/' + (category | getCategorySlug(collections)) + '/') | url }}">{{ category }}</a>
            </p>
          {% endif %}
          {% if project and project.length > 0 %}
            <p><strong>ä¸“é¢˜:</strong>
              {% for proj in project %}
                {# [OPTIMIZATION] Use getProjectSlug helper #}
                <a class="taxonomy-link" href="{{ ('/projects/' + (proj | getProjectSlug(collections)) + '/') | url }}">{{ proj }}</a>{% if not loop.last %}, {% endif %}
              {% endfor %}
            </p>
          {% endif %}
        </div>
      {% endif %}

      {# ç¬¬ä¸€éƒ¨åˆ†ï¼šä¸»è®²äººå’Œæ¥æºä¿¡æ¯ #}
      {% if speaker %}
        <p><strong>ä¸»è®²äºº:</strong>
          {# å¤„ç†å¤šä¸ªæ¼”è®²è€…çš„æƒ…å†µï¼Œç”¨é€—å·åˆ†éš” #}
          {% set speakers = speaker.split(',') %}
          {% for speakerName in speakers %}
            {% set trimmedSpeaker = speakerName.trim() %}
            {% if trimmedSpeaker != '' %}
              {# [OPTIMIZATION] Use getSpeakerSlug helper #}
              <a class="speaker-link" href="{{ ('/speakers/' + (trimmedSpeaker | getSpeakerSlug(collections)) + '/') | url }}">{{ trimmedSpeaker }}</a>{% if not loop.last %}, {% endif %}
            {% endif %}
          {% endfor %}
        </p>
      {% endif %}

      {% if guest %}
        <p><strong>å˜‰å®¾:</strong>
          {# å¤„ç†å¤šä¸ªå˜‰å®¾çš„æƒ…å†µï¼Œç”¨é€—å·åˆ†éš” #}
          {% set guests = guest.split(',') %}
          {% for guestName in guests %}
            {% set trimmedGuest = guestName.trim() %}
            {% if trimmedGuest != '' %}
              {# [OPTIMIZATION] Use getSpeakerSlug helper #}
              <a class="speaker-link" href="{{ ('/speakers/' + (trimmedGuest | getSpeakerSlug(collections)) + '/') | url }}">{{ trimmedGuest }}</a>{% if not loop.last %}, {% endif %}
            {% endif %}
          {% endfor %}
        </p>
      {% endif %}

      {% if source %}
        <p><strong>æ¥æº:</strong> <a href="{{ source }}" target="_blank">æŸ¥çœ‹</a></p>
      {% endif %}

      {% if channel %}
        <p><strong>é¢‘é“:</strong> {{ channel }}</p>
      {% endif %}

      {# ç¬¬äºŒéƒ¨åˆ†ï¼šå‘å¸ƒæ—¶é—´ #}
      {% if date %}
        <p><strong>å‘å¸ƒæ—¶é—´:</strong>
          {% if date.toLocaleDateString %}
            {{ date.toLocaleDateString() }}
          {% else %}
            {{ date }}
          {% endif %}
        </p>
      {% endif %}

      {# ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ‘˜è¦å’Œå…³é”®å­— #}
      {# æ‘˜è¦éƒ¨åˆ† #}
      {% if summary %}
        <div class="summary-section">
          <p><strong>æ‘˜è¦:</strong></p>
          <div class="summary-content">{{ summary }}</div>
        </div>
      {% endif %}

      {# æ´å¯Ÿéƒ¨åˆ† #}
      {% if insight %}
        <div class="insight-section">
          <p><strong>æ´å¯Ÿ:</strong></p>
          <div class="insight-content">{{ insight }}</div>
        </div>
      {% endif %}
    </div>

    {# ------------------- å…ƒæ•°æ®å—ä»£ç ç»“æŸ ------------------- #}

    {{ content | safe }}

    {# ------------------- æ–‡ç« æœ«å°¾å…ƒæ•°æ®å¼€å§‹ ------------------- #}

    {# å®ä½“æå–ä¿¡æ¯ (v7.4) - ä½¿ç”¨å¯æŠ˜å åŒºåŸŸ #}
    {% if people or companies_orgs or products_models or media_books %}
      <div class="entity-section">
        <details class="entity-details">
          <summary>ğŸ“Œ æ–‡ä¸­æåŠçš„äººç‰©å’Œç»„ç»‡</summary>
          <div class="entity-content">
            {% if people and people.length > 0 %}
              <p><strong>äººç‰©:</strong>
                {% for person in people %}
                  {# [OPTIMIZATION] Use getPersonSlug helper #}
                  <a href="{{ ('/people/' + (person | getPersonSlug(collections)) + '/') | url }}" class="entity-link person-link">{{ person }}</a>{% if not loop.last %}, {% endif %}
                {% endfor %}
              </p>
            {% endif %}
            {% if companies_orgs and companies_orgs.length > 0 %}
              <p><strong>å…¬å¸/ç»„ç»‡:</strong>
                {% for company in companies_orgs %}
                  {# [OPTIMIZATION] Use getCompanySlug helper #}
                  <a href="{{ ('/companies-orgs/' + (company | getCompanySlug(collections)) + '/') | url }}" class="entity-link company-link">{{ company }}</a>{% if not loop.last %}, {% endif %}
                {% endfor %}
              </p>
            {% endif %}
            {% if products_models and products_models.length > 0 %}
              <p><strong>äº§å“/æ¨¡å‹:</strong>
                {% for product in products_models %}
                  {# [OPTIMIZATION] Use getProductSlug helper #}
                  <a href="{{ ('/products-models/' + (product | getProductSlug(collections)) + '/') | url }}" class="entity-link product-link">{{ product }}</a>{% if not loop.last %}, {% endif %}
                {% endfor %}
              </p>
            {% endif %}
            {% if media_books and media_books.length > 0 %}
              <p><strong>åª’ä½“/ä¹¦ç±:</strong>
                {% for media in media_books %}
                  {# [OPTIMIZATION] Use getMediaSlug helper #}
                  <a href="{{ ('/media-books/' + (media | getMediaSlug(collections)) + '/') | url }}" class="entity-link media-link">{{ media }}</a>{% if not loop.last %}, {% endif %}
                {% endfor %}
              </p>
            {% endif %}
          </div>
        </details>
      </div>
    {% endif %}

    {# å…³é”®å­—éƒ¨åˆ† - ç§»åˆ°æ–‡ç« æ­£æ–‡ä¹‹å #}
    {% if tags %}
      <div class="tags-section">
        <p><strong>å…³é”®å­—:</strong>
          {% for tag in tags %}
            {% if tag != "post" and tag != "note" and tag != "è§†é¢‘æ–‡ç¨¿" %}
              {# [OPTIMIZATION] Use getTagSlug helper #}
              <a class="tag-link" href="{{ ('/tags/' + (tag | getTagSlug(collections)) + '/') | url }}">{{ tag }}</a>
            {% endif %}
          {% endfor %}
        </p>
      </div>
    {% endif %}

    {# ------------------- æ–‡ç« æœ«å°¾å…ƒæ•°æ®ç»“æŸ ------------------- #}

    {# ------------------- ç³»åˆ—ç›¸å…³æ–‡ç« å¼€å§‹ ------------------- #}
    {% if series and series.trim() != '' %}
      {% set relatedPosts = collections.allItems | filterExcluded %}
      {% set sameSeries = [] %}
      
      {# æ‰¾åˆ°åŒä¸€ç³»åˆ—çš„å…¶ä»–æ–‡ç«  #}
      {% for post in relatedPosts %}
        {% if post.data.series and post.data.series.trim() == series.trim() and post.url != page.url %}
          {% set sameSeries = (sameSeries.push(post), sameSeries) %}
        {% endif %}
      {% endfor %}

      {# å¦‚æœæœ‰åŒç³»åˆ—çš„æ–‡ç« ï¼Œæ˜¾ç¤ºç›¸å…³æ–‡ç« åŒºå— #}
      {% if sameSeries.length > 0 %}
        <div class="related-series">
          <h3>æœ¬ç³»åˆ—å…¶ä»–æ–‡ç« </h3>
          <p class="series-name">ç³»åˆ—ï¼š{{ series }}</p>
          <ul class="related-posts-list">
            {% for post in sameSeries | sort(false, false, 'date') %}
              <li class="related-post-item">
                <a href="{{ post.url }}" class="related-post-link">
                  <span class="related-post-title">{{ post.data.title }}</span>
                  {% if post.data.date %}
                    {% if post.data.date.toLocaleDateString %}
                      <span class="related-post-date">{{ post.data.date.toLocaleDateString() }}</span>
                    {% else %}
                      <span class="related-post-date">{{ post.data.date }}</span>
                    {% endif %}
                  {% endif %}
                </a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    {% endif %}
    {# ------------------- ç³»åˆ—ç›¸å…³æ–‡ç« ç»“æŸ ------------------- #}
  </main>

  {# å…¨å±€å±•å¼€/æŠ˜å è‹±æ–‡åŸæ–‡æŒ‰é’® #}
  <button class="toggle-all-details-btn" id="toggleAllDetailsBtn" aria-label="å±•å¼€/æŠ˜å æ‰€æœ‰è‹±æ–‡åŸæ–‡">
    <span class="icon">ğŸ“–</span>
    <span class="btn-text">å±•å¼€å…¨éƒ¨åŸæ–‡</span>
  </button>

</div>

<script src="{{ '/js/post.js' | url }}"></script>
<script src="{{ '/js/toggle-details.js' | url }}"></script>