---
author: Lei
date: 2025-07-31
guest: Cal
layout: post.njk
channel: null
source: https://www.youtube.com/watch?v=gv0WHhKelSE
speaker: Cal
tags:
- 视频文稿
- Claude Code
- AI 编程助手
- Prompt Engineering
- AI 代理
title: Anthropic 专家 Cal 深度解析：Claude Code 最佳实践与高级技巧
summary: Anthropic 应用 AI 团队的核心贡献者 Cal 深入介绍了 AI 编码助手 Claude Code。他分享了 Claude Code 作为纯粹代理的工作原理、多样化的应用场景，并详细阐述了包括使用
  claude.md、上下文管理和多代理协作在内的最佳实践与高级技巧。
insight: null
file_name: claude_code_best_practices_and_advanced_techniques.md
draft: true
series: null
---

## 开场与自我介绍

Let's get started. Welcome everyone to Cloud Code best practices. In this talk, I'm going to talk about kind of what cloud code is at a high level. Then we'll peer under the hood a little bit to kind of understand how cloud code works. And then knowing that because it's useful to kind of know how your tools work. We're going to talk about good use cases for cloud code and also best practices we've figured out both internally and from our users uh for getting the most out of this tool. Uh but before I get started, I'd like to introduce myself real quick and talk about how I ended up on the stage. So, my name's Cal and I joined Enthropic about a year and a half ago uh to help start up a team we call applied AI. And it's the applied AI's kind of mission, our team's mission is to help our customers and partners build great products and features on top of Claude. So what that really means is I spend a lot of my day prompting Claude to get the absolute best outputs out of these models. That said, I also love to code and I'm definitely one of those coders that like starts a lot of projects, has some crazy idea, and then just never finishes them. So, I have this graveyard of just like code that I started, never really finished. Um, but I'm always spinning new things up. And late last year, I was in Slack and I was hearing about this new tool that a few people are using. They were saying it was really cool. And so, on a Friday night, I downloaded the tool that would become Cloud Code. And I threw it at this kind of new notetaking app that I wanted to build. And like that whole weekend just kind of totally changed the way that I code and think about software engineering. I was carrying around my laptop with me all weekend. I was super addicted to just watching Claude Code work and I would press enter and I'd switch over to my browser and refresh and I watched this huge powerful application come together in front of my eyes. And I got way farther into this thing than I ever would have on my own. And it just blew my mind. And while I was doing this, I was a little worried. I was like, you know, I kind of know how these things work. So I'm like, man, I'm using a lot of tokens. I hope I don't get in trouble or anyone like notices. I'm not really contributing to anthropic code. Um, but what I didn't know is that the claude code team had built this internal like leaderboard tracking how much all the anthropic employees were using this. And over the weekend, I had shot to the top. And so through that, I got to meet Boris and Cat and some of the early cloud code team. And I was able to start talking to them and say, "Hey, I love this tool. I also know a lot about prompting. Can I help you all out?" And so through that I got involved and now I'm one of the core contributors on the team and I do a lot of I work a lot on the prompting the system prompts how the tools work the tool descriptions and tool results as well as I work on how we evaluate this tool. So when we think about changing the prompts how do we make how do we know we made things better or the same and we didn't totally ruin cloud code.

我们开始吧。欢迎大家来到 Claude Code 最佳实践分享会。在这次演讲中，我将首先宏观地介绍一下什么是 **Claude Code**。然后我们会稍微深入了解一下它的内部工作原理。了解这些之后，因为了解你所使用的工具的工作方式是很有用的，我们将讨论 Claude Code 的一些好的应用场景，以及我们从内部和用户那里总结出的、能最大限度发挥这个工具效能的最佳实践。但在开始之前，我想快速自我介绍一下，并谈谈我是如何站在这里的。我的名字是 Cal，我大约一年半前加入了 Anthropic，帮助创建了一个我们称之为“应用 AI”的团队。我们团队的使命是帮助我们的客户和合作伙伴在 Claude 的基础上构建出色的产品和功能。这实际上意味着我每天花大量时间给 Claude 写**提示**（Prompting），以从这些模型中获得绝对最佳的输出。话虽如此，我也热爱编程，而且我绝对是那种会开始很多项目、有一些疯狂想法，但最终却从不完成它们的程序员。所以，我有一个堆满了只开了头却从未真正完成的代码的“代码坟场”。但我总是在构思新的东西。去年年底，我在 Slack 上听说有一个新工具，有几个人在用，他们说非常酷。于是，在一个周五晚上，我下载了那个后来成为 Claude Code 的工具，并用它来构建一个我想做的新的笔记应用。那个周末完全改变了我编程和思考软件工程的方式。整个周末我都随身带着我的笔记本电脑，我完全沉迷于看着 Claude Code 工作。我按下回车，然后切换到浏览器刷新，眼睁睁地看着一个巨大而强大的应用程序在我眼前成型。我在这件事上取得的进展，远远超过了我自己一个人能达到的程度。这简直让我大开眼界。在做这件事的时候，我有点担心。我想，我大概知道这些东西是怎么工作的，我心想：“天哪，我用了好多 **token**（代币/令牌）啊，希望我不会惹上麻烦，或者被人注意到我其实没有在为 Anthropic 的代码做贡献。”但我不知道的是，Claude Code 团队建立了一个内部排行榜，追踪所有 Anthropic 员工的使用情况。那个周末，我一跃登顶。通过这件事，我认识了 Boris、Cat 和一些早期的 Claude Code 团队成员。我开始和他们交谈，说：“嘿，我超爱这个工具。我也很懂提示工程，我能帮你们吗？” 就这样，我参与了进来，现在我是团队的核心贡献者之一。我主要负责系统提示、工具的工作方式、工具描述和工具结果等提示工程相关的工作，同时也负责我们如何评估这个工具。所以当我们考虑改变提示时，我们如何知道我们是改进了还是保持原样，而没有把 Claude Code 彻底搞砸。

## Claude Code 的心智模型与工作原理

So with that said let's kind of dive in. So, here's my current mental model of Claude Code and how I describe it to people when people ask me. Claude Code is like that co-worker that does everything on the terminal. It's the sort of person that just never touches the guey. They're a whiz. I think of when I was a junior engineer, I had this mentor and I would walk over to his desk and I would say, "Hey, Tony, can you help me with this bug?" and he would whipping it open his terminal and he'd be like doing all these crazy bash commands and changing things around in Vim and I'd always walk away thinking, "Wow, that was crazy. I should learn how to do that." Um, I never did. But having Claude Code on your computer is kind of like having Tony next to you all the time.

说了这么多，我们进入正题吧。这是我目前对 Claude Code 的心智模型，也是当别人问起时我向他们描述的方式。Claude Code 就像是那种所有事情都在**终端**（Terminal）里完成的同事。他是那种从不碰图形用户界面（GUI）的人，一个技术高手。我想起我当初级工程师的时候，我有一个导师。我会走到他的办公桌前说：“嘿，托尼，你能帮我解决这个 bug 吗？”他会迅速打开他的终端，执行各种疯狂的 **bash** 命令，在 **Vim**（一款强大的文本编辑器）里修改东西。我每次离开时都会想：“哇，太疯狂了，我应该学学那个。” 嗯，我从来没学。但是，在你的电脑上拥有 Claude Code，就好像托尼一直坐在你旁边。

So, how does Claude code kind of work under the hood? At Anthropic, we try to always do what we call the simple thing that works. And what that means for Cloud Code is it's what we would consider a very pure agent. And anthropic, when we talk about agents, what we really mean is some instructions, some powerful tools, and you let the model just run in a loop until it decides it's done. And that's really what Cloud Code is. So it's tools, powerful tools, and the tools that you know someone that was really good at a terminal would be able to use tools to create and edit files to use the terminal. And then you can also do things like pull in other things with MCP. Now, on top of that, there's how Claude understands the codebase. And if you're going to build a coding agent or a coding tool a year ago, you'd probably have ideas like, well, okay, I'm going to get this user message about something about this codebase and I'll need to figure out which files are relevant. So maybe I'll like index the whole codebase and embed it and do this fancy like kind of rag retrieval thing. That is not how cloud code works. We don't do any sort of indexing. Instead, claude kind of explores and understands the codebase. how you if you were new to a team and new to a codebase would explore a codebase and that is through a gentic search is the same sort of search tools you or I would use things like glob and gp and find and it can work its way through a codebase and understand what's going on and when we talk about a gentic search that really means the model can go do some searches and then it can look at the results and can say hm maybe I need to figure out a few more things I'm going to go do some more searching and then come back and then on top of these primitives. On top of this agent, we have a few things. We have a very nice light UI layer where you get to watch Claude code work. You see all the text fly by and we have this nice permission system that allows the agent to work and allows and kind of forces the human to butt in when the agent is doing something dangerous. And then on top of that, we also care a lot about security in this tool. And so because quad code is just such a lightweight kind of layer on top of the model and the fact that our model is available not just behind anthropic APIs but also with our cloud providers AWS and GCP it's very easy and native to point cloud code at one of these other services if you feel more comfortable consuming cloud that way.

那么，Claude Code 的底层是如何工作的呢？在 Anthropic，我们总是尝试做我们所谓的“简单有效的事情”。对 Claude Code 来说，这意味着它是一个我们认为非常纯粹的**代理**（Agent）。在 Anthropic，当我们谈论代理时，我们真正的意思是一些指令、一些强大的工具，然后你让模型在一个循环中运行，直到它决定完成任务。这正是 Claude Code 的本质。所以，它拥有强大的工具，是一个终端高手会使用的那种工具，比如创建和编辑文件、使用终端。你还可以通过 **MCP**（模型-客户端协议）来引入其他东西。在此之上，是 Claude 理解代码库的方式。如果一年前你要构建一个编码代理或工具，你可能会想：“好的，我会收到用户关于这个代码库的消息，我需要找出哪些文件是相关的。所以也许我会索引整个代码库，进行嵌入，然后做一个花哨的**检索增强生成**（RAG, Retrieval-Augmented Generation）之类的事情。” 但 Claude Code 不是这样工作的。我们不做任何形式的索引。相反，Claude 会像一个刚加入团队、接触新代码库的人一样，去探索和理解代码库。这是通过**代理式搜索**（Agentic Search）实现的，它使用的搜索工具和我们一样，比如 `glob`、`grep` 和 `find`。它可以逐步浏览代码库并理解其中的内容。当我们谈论代理式搜索时，这真正意味着模型可以进行一些搜索，然后查看结果，并思考：“嗯，也许我需要再搞清楚几件事”，然后再进行更多搜索，然后再回来。在这些基础功能之上，在这个代理之上，我们还有一些东西。我们有一个非常漂亮的轻量级用户界面（UI）层，你可以看着 Claude Code 工作，看到所有文本飞速闪过。我们还有一个很好的权限系统，它允许代理工作，并在代理做一些危险操作时，强制人类介入。除此之外，我们也非常关心这个工具的安全性。因为 Claude Code 只是模型之上的一个非常轻量级的层，而且我们的模型不仅可以通过 Anthropic 的 API 使用，还可以通过我们的云服务提供商 AWS 和 GCP 使用，所以如果你觉得通过其他服务使用 Claude 更舒服，将 Claude Code 指向这些服务是非常容易和原生的。

## Claude Code 的多样化应用场景

Now a lot of people ask me hey Cal what can I use cloud code for? Like what is it good at? where is it interesting? And the reality is it's kind of great at everything. So let's start with discovery. Often times in your career, you will be dropped into a new codebase. Whether that means you're switching teams, you're switching companies, I don't know, you're starting to work on some sort of open source project. And probably when you're first getting started and getting familiar, you're not very productive because you're just trying to figure out where things are in the codebase, what patterns kind of the team is using, things like that. And Claude code can kind of help supercharge that onboarding process. You can ask claude, hey, where is this feature implemented? Or since it's great at the terminal, you can say, hey, look at this file and look at the git history and just kind of tell me a story about how this code has changed over the past couple weeks.

很多人问我：“嘿，Cal，Claude Code 能用来做什么？它擅长什么？有趣在哪里？” 现实是，它几乎无所不能。我们先从**探索（Discovery）**开始。在你的职业生涯中，你经常会被扔进一个新的代码库，无论是换团队、换公司，还是开始参与某个开源项目。刚开始熟悉的时候，你可能效率不高，因为你只是在试图搞清楚代码库的结构、团队使用的模式等等。Claude Code 可以极大地加速这个上手的过程。你可以问 Claude：“嘿，这个功能是在哪里实现的？” 或者，因为它精通终端，你可以说：“嘿，看看这个文件，看看它的 git 历史，给我讲讲过去几周这段代码是怎么变化的。”

One thing you can use cloud code for, and I think this is underrated, is instead of just diving in and starting to work, you can use cloud code as a thought partner. So oftent times when I'm working with Claude and I want to implement a feature or we're going to change something up, I'll open up Claude and I'll say, "Hey Claude, you know, I'm thinking about implementing this feature, can you just kind of like search around and kind of figure out how we would do it and maybe report back with like two or three different options. Don't start working. don't start writing any files writing any files yet and claude will go off and use those agentic search capabilities and come back with a few ideas and then I could work with claude to kind of validate things and then we can jump into the project of course cloud code is great at building and writing code and I would say this in on two different fronts one it can do the zero to one sort of stuff you drop it in an empty directory and you say hey build me an app build me a game that demos where very well it's very fun to do it's very grat gratifying. Of course, in reality, what really matters is is cloud code good working in existing code bases. And this is primarily what we focus on. Um, on the cloud code team, we have in our codebase abnormally high, I would say, unit test coverage. And that's because cloud code makes it so easy and just straightforward to add unit tests. So, we have great code coverage. And then the other thing we have in cloud code in our own codebase is we have great commits and PR messages because when we finish working we'll just say hey cloud write the commit for me write the PR message for me. We also see great opportunities to use cloud code in kind of the deployment like deployments and in other parts of the life cycle. And this is a few other people have talked about this but this is using the cloud code SDK. So using it headlessly, using it programmatically, being able to sprinkle in a coding agent agent anywhere. And so that's things like sprinkling it into CI/CD to use it in GitHub for instance to help people um programmatically. And then finally, it's great kind of with support and scale. It can help you debug errors faster. One thing that we saw when we started giving cloud code to customers and talking to them about it, we didn't totally predict this was a lot of customers or potential customers said, "Hey, we've been me we've been kind of putting off this like large codebase migration. People that are on old versions of Java trying to get to a new one or a team that's on PHP and they're trying to get to React or Angular. We've talked to multiple teams like this and having a tool like Cloud Code makes projects like that a little more digestible. when you go to your team and you say, "Hey, we're going to spend a month, you know, refactoring or rewriting large parts of the codebase." And then on top of that, and this kind of matters across all these, is once again remember Claude is great at the terminal. And that means it's going to be great at all those different CLI tools, things like Git, Docker, Big Query, things like that. I never have to worry about, oh, I'm going to get myself, how do I get myself out of this sticky rebase? I'll just fire up cloud code and tell it the situation and be like, "Hey, can you fix this for me?" It's incredible.

你可以用 Claude Code 做的一件事，我认为这被低估了，就是把它当作一个**思考伙伴（Thought Partner）**，而不是直接一头扎进去开始工作。很多时候，当我想实现一个功能或做一些改动时，我会打开 Claude 说：“嘿，Claude，我正在考虑实现这个功能，你能不能搜索一下，看看我们该怎么做，然后给我反馈两三个不同的方案。先别开始工作，别写任何文件。” 然后 Claude 就会利用它的代理式搜索能力，带回一些想法。接着我就可以和 Claude 一起验证这些想法，然后再开始项目。当然，Claude Code 非常擅长**构建和编写代码（Building）**。这体现在两个方面：一是从零到一的创建，你把它放在一个空目录里，说“嘿，给我建个应用”，或者“建个游戏”，演示效果很好，做起来也很有趣，很有成就感。当然，在现实中，真正重要的是 Claude Code 在现有代码库中的工作表现如何。这正是我们主要关注的。在 Claude Code 团队，我们自己代码库的单元测试覆盖率高得异常，这是因为它让添加单元测试变得非常简单直接。此外，我们的 **commit**（提交）和 **PR**（拉取请求）信息也写得很好，因为当我们完成工作后，我们只会说：“嘿，Claude，帮我写 commit 信息，帮我写 PR 信息。” 我们还看到了在**部署（Deployment）**和其他生命周期环节中使用 Claude Code 的巨大机会。这涉及到使用 Claude Code 的 **SDK**（软件开发工具包），以无头（headless）和编程的方式使用它，能够在任何地方嵌入一个编码代理。比如，把它嵌入到 **CI/CD**（持续集成/持续部署）流程中，或者在 GitHub 中以编程方式帮助人们。最后，它在**支持和扩展（Support & Scale）**方面也很出色。它可以帮助你更快地调试错误。当我们开始向客户提供 Claude Code 并与他们交流时，我们发现了一个完全没预料到的情况：很多客户说：“嘿，我们一直在推迟一个大型代码库迁移项目。” 比如从旧版 Java 升级到新版，或者从 PHP 迁移到 React 或 Angular。我们和很多这样的团队聊过，拥有像 Claude Code 这样的工具，使得这类项目变得更容易处理。最重要的是，贯穿所有这些场景的是，再次记住，Claude 精通终端。这意味着它能很好地处理所有不同的 **CLI**（命令行界面）工具，比如 **Git**、**Docker**、**BigQuery** 等。我再也不用担心：“哦，我怎么才能摆脱这个棘手的 rebase 困境？” 我只需启动 Claude Code，告诉它情况，然后说：“嘿，能帮我解决吗？” 简直不可思议。

## Claude Code 最佳实践

### 使用 claude.md 文件

Now, let's talk about best practices. And the first one is not going to be a surprise, but the first one is use claw.md files. So, remember that cloud code, like I said, is an agent and it has some tools, has some lightweight instructions in the prompt, but it doesn't really have memory. And so the main way we share state across kind of sessions or across our team when we fire up cla code in the same codebase over and over again is this cloud.mmd file. So when we start cla what happens is if there's this claw.md file in the working directory it's just plopped into context. It's plopped into the prompt. And basically what it says is hey claude by the way these are important instructions the developer left for you. Be sure to pay close attention to this. And there's various places you can put the cloudmd file. You can put it in a project and check it in so all your teammates share it. You could put one in your home directory if there's things you just want claude to always know about regardless of what you're working on. And the things you put in here are things like, hey, by the way, maybe this is how you run the unit tests. Or just so you know, to make kind of your searching and life easier, here's like just like an overview of kind of how this project is laid out, where the tests live, what different modules are, things like that. or here's our style guide. All sorts of things like that to just make Claude's life a bit easier. And you can build these things up over time.

现在，我们来谈谈最佳实践。第一个不会让你感到意外，那就是**使用 `claude.md` 文件**。记住，就像我说的，Claude Code 是一个代理，它有一些工具和一些轻量级的提示指令，但它并没有真正的记忆。因此，当我们在同一个代码库中反复启动 Claude Code 时，跨会话或在团队之间共享状态的主要方式就是这个 `claude.md` 文件。当我们启动 Claude 时，如果工作目录中存在这个 `claude.md` 文件，它就会被直接放入上下文，也就是放入提示中。它基本上是在说：“嘿，Claude，顺便说一下，这些是开发者留给你的重要指令，请务必密切关注。” 你可以把 `claude.md` 文件放在不同的地方。你可以把它放在项目中并提交，这样所有团队成员都能共享。你也可以在你的主目录放一个，如果有些事情你希望 Claude 无论在做什么项目时都知道。你可以在里面放这样的内容，比如：“嘿，顺便说一下，这可能是运行单元测试的方法。” 或者：“为了让你搜索和工作更轻松，这里是这个项目的布局概览，测试在哪里，有哪些不同的模块等等。” 或者：“这是我们的风格指南。” 各种类似的东西，只是为了让 Claude 的工作轻松一点。你可以随着时间的推移不断完善这些内容。

### 权限管理

The other thing you can do, which is important, is permission management. When you're running Cloud Code, there's all sorts of different kind of permission things flying by. Kind of out of the box, what happens when you start our tool is for read actions. If Claude is searching or reading, we just let it go. But once it starts writing or running bash commands or doing things that could change change stuff on your machine potentially, that's when we kick in this UI and it says something like yes, yes, always allow this or no, um, I want to do something else. And using that permission management and being smart about it can help you work faster. So there's something called autoaccept mode where if you're working with cloud code and you press shift tab, claude will just start working. There's things you can do like you can configure claude in the settings where specific commands like on bash like if you just are like tired of saying yes run npm run test you can just always approve that. So fiddling with your permission management is a great way to kind of speed up your workflow integration setup.

另一件你可以做也很重要的事情是**权限管理**。当你运行 Claude Code 时，会有各种不同的权限请求弹出。开箱即用的情况下，对于读取操作，比如 Claude 在搜索或读取文件，我们就让它直接执行。但一旦它开始写入、运行 bash 命令或做一些可能改变你机器上东西的操作时，我们的 UI 就会介入，并询问你“是”、“始终允许”或“否，我想做点别的”。聪明地使用这个权限管理可以帮助你更快地工作。有一个叫做“自动接受模式”，如果你在使用 Claude Code 时按下 `Shift`+`Tab`，Claude 就会直接开始工作。你还可以在设置中配置 Claude，比如对于特定的 bash 命令，如果你厌倦了总是对 `npm run test` 说“是”，你可以直接将其设置为始终批准。所以，调整你的权限管理是加速工作流程的一个好方法。

### 集成设置

So, one thing that is going to help you get the most out of cloud code is remember that it's great at the terminal. And if there's applications that you use which have kind of a way to access them through CLI and GitHub is a great example of that. They have a powerful tool called GH you can basically give more work to cloud code and you can do that either by just installing more CLI tools or you can attach more MCP servers. Um, I would say just through experience that if you're using something like um, a CLI tool that's well known and well documented and you're trying to choose between the CLI tool and just installing it on your machine and grabbing an MCP server, I would recommend using the CLI tool. Um, and then also if you internally have your own tools at Anthropic, we have something called coup that does a whole bunch of stuff for us. You can also tell Claude about that and you pro that's the sort of thing you'd put in claude.mmd

有一件事能帮助你最大限度地利用 Claude Code，那就是记住它非常擅长使用终端。如果你使用的应用程序有通过 **CLI**（命令行界面）访问的方式，GitHub 就是一个很好的例子。他们有一个强大的工具叫做 `gh`。你基本上可以给 Claude Code 更多的工作，这可以通过安装更多的 CLI 工具或附加更多的 **MCP** 服务器来实现。根据经验，如果你正在使用一个众所周知且文档齐全的 CLI 工具，并且在“直接安装 CLI 工具”和“获取一个 MCP 服务器”之间选择，我推荐使用 CLI 工具。另外，如果你内部有自己的工具，比如在 Anthropic，我们有一个叫做 `coup` 的工具，它为我们做了很多事情，你也可以告诉 Claude 关于它的信息，这正是你应该放在 `claude.md` 里的那种东西。

### 上下文管理

and then context management. So remember that claude is an agent and when it's an a what what it does it's calls these tools and the context builds up and up over time and at least for anthropic our models have a context window of 200,000 tokens and you can max this thing out. So you kind of have two options when you're in a long session with claude and you're working and you're going back and forth. You'll see in the bottom right you'll start to get this little warning that'll say hey you're starting to fill up the context window and kind of depending on what's going on you have two options. You can run slashcle and just start over and that clears everything out except for for instance claw.mmd or you can run slash compact and what'll happen is basically it's like a user message is inserted and it just says something like hey I need to go summarize everything we've been up to. I'm going to give this to another developer and they're going to pick up where I left off. And then that summary is what kind of seeds the next session. You can go from there. We spend a lot of time tuning this kind of compact functionality so that as you max out the context window and then run compact, you can start back over and keep going efficient workflows.

接下来是**上下文管理**。记住，Claude 是一个代理，它会调用这些工具，上下文会随着时间的推移不断累积。至少对于 Anthropic 的模型来说，我们的上下文窗口有 20 万个 token，你可能会用满它。所以，当你在和 Claude 进行一个长时间的会话，来回工作时，你会看到右下角开始出现一个小警告，告诉你上下文窗口快满了。根据情况，你有两个选择。你可以运行 `/clear` 命令，重新开始，这会清除除了 `claude.md` 之外的所有东西。或者你可以运行 `/compact` 命令，这基本上就像插入了一条用户消息，说：“嘿，我需要总结一下我们目前所做的一切，我会把这个交给另一个开发者，他会从我停止的地方继续。” 然后这个总结就会成为下一个会话的种子，你可以从那里继续。我们花了很多时间来调整这个“压缩”功能，这样当你的上下文窗口满了之后，运行压缩，你就可以重新开始并继续高效地工作。

## 高效工作流与高级技巧

### 使用计划和待办事项

What can you do with cloud code? And how do you get the most out? So using planning and to-dos. talked a little bit about this before, but one of the best things you can do is when you open up Cloud Code, instead of saying, "Hey, I need you to fix this bug," you can say, "Hey, I have this bug. Can you search around, figure out what's causing it, and just like tell me a plan how we're going to fix it?" And this can save you a lot of time because you can verify, you can read Claude's plan, and you can verify what it's going to do. And then the other thing that we have is we have this to-do list feature. So often when Claude's working on a big task, it'll create a to-do list. And if you're kind of paying attention, you can kind of watch this to-do list, and if you see anything kind of weirder in there or something that doesn't make sense, that's when you can press escape and say, "Hey Claude, let's change the to-do list. I think you're on the wrong path."

你能用 Claude Code 做什么？如何最大限度地利用它？答案是**使用计划和待办事项**。之前稍微提过，但最好的做法之一是，当你打开 Claude Code 时，不要直接说：“嘿，我需要你修复这个 bug。” 你可以说：“嘿，我有一个 bug。你能搜索一下，找出原因，然后告诉我一个修复计划吗？” 这可以为你节省大量时间，因为你可以阅读 Claude 的计划，并验证它将要做什么。我们还有**待办事项列表（to-do list）**功能。通常当 Claude 在处理一个大任务时，它会创建一个待办事项列表。如果你留意观察，看到列表里有什么奇怪或不合理的地方，你就可以按 `Escape` 键说：“嘿，Claude，我们改一下待办事项列表，我觉得你走错路了。”

### 智能结对编程

Smart vibe coding. So it's very tempting and it's very powerful to just let Claude work and press enter and see what happens at the end. I think there's a few things that can help make this better. And there's I think a talk later today about just this for 30 minutes. But doing things like having test-driven development, having Claude make small changes, run the tests, make sure they pass, always having Claude do things like check the TypeScript and the linting, and then commit regularly so that if it's kind of going off the rails, you can always fall back and try again.

**智能结对编程**。让 Claude 自行工作，按下回车然后看结果，这非常诱人也很有用。但我认为有几件事可以做得更好。比如，采用**测试驱动开发**（Test-Driven Development），让 Claude 做小范围的改动，运行测试，确保通过；总是让 Claude 检查 TypeScript 和代码风格（linting）；然后定期提交，这样如果它偏离了轨道，你总能回退重试。

### 使用截图进行指导和调试

You can use screenshots to guide and debug. So Claude is built on top of our models which are multimodal. You can always just grab a screenshot, paste it in, or if you have a file somewhere that's an image, you can just say, "Hey, Claude, look at this mock.png and then build the website for me or whatever."

你可以**使用截图来指导和调试**。Claude 是建立在我们的多模态模型之上的。你随时可以截个图然后粘贴进去，或者如果你有图片文件，你可以直接说：“嘿，Claude，看看这个 `mock.png`，然后帮我构建网站。”

### 高级技巧

And then advanced techniques. So, as you're getting used to using Claude, what are some things you can think about uh to kind of push things to the next level? And one of the things we see both internally and with customers is when you've started to use this tool for a while, it's going to be very tempting to use multiple clouds at once. And so I know people at Anthropic and a few customers that run four clouds at the same time. There's various ways to do this. You can have it in T-Mox or just different tabs, all sorts of crazy things. So I would challenge you to try getting multiple clubs running at once and kind of be orchestrating all these things. It's quite fun. I can only do two, but I know people that do four. Use escape. So, escape is your best friend. While Claude is working, you can kind of keep an eye on what it's up to, and you can press escape to stop it and interject and say, "Hey, I think you're going on the wrong path, or I want you to do something else." Knowing when the right time to press escape is versus just letting Claude figure it out, is key to getting the most out of the tool. And there's a hidden feature. Not too many people know about it, but if you press escape twice, you can actually jump back in your conversation. You can go back and you can kind of reset tool expansion in MCP. So, this is taking it to the next level. If you feel like with bash and with the tools that cloud has that it still can't do something, this is when you should start looking at MCP servers. And then headless automation. And I think this is the thing we're most excited about, but also we are still trying to wrap our heads around internally, which is how can we use Claude programmatically. We have that in GitHub actions. We want to figure out other creative places we can start using it. I would challenge you all to do the same.

接下来是**高级技巧**。当你逐渐习惯使用 Claude 后，有哪些方法可以更上一层楼呢？我们内部和客户都发现，当你使用这个工具一段时间后，你会很想**同时使用多个 Claude 实例**。我知道 Anthropic 有些人和一些客户会同时运行四个 Claude。有很多方法可以实现，比如在 **Tmux**（一个终端复用器）里，或者在不同的标签页里。我建议你们尝试同时运行多个 Claude 并协调它们，这很有趣。我只能同时处理两个，但我知道有人能处理四个。**使用 `Escape` 键**。`Escape` 是你最好的朋友。当 Claude 在工作时，你可以留意它的进展，随时按 `Escape` 键打断它，并说：“嘿，我觉得你走错路了”，或者“我想让你做点别的”。知道何时按 `Escape`，何时让 Claude 自己解决，是最大限度利用这个工具的关键。还有一个隐藏功能，没多少人知道，如果你**连按两次 `Escape`**，你可以跳回到之前的对话中。**工具扩展与 MCP**。如果你觉得 Claude 已有的 bash 和工具仍然无法满足你的需求，这时你就应该开始研究 MCP 服务器了。最后是**无头自动化（Headless Automation）**。我想这是我们最兴奋的事情，但我们内部也还在摸索，那就是如何以编程方式使用 Claude。我们已经在 GitHub Actions 中实现了，我们想找出更多有创意的地方来使用它。我鼓励大家也这样做。

## 最新功能演示

So, with that said, uh I'm going to jump over to my computer because there's one other best practice, which is it's always good to stay on top of everything that's new. So, we're shipping super fast. I'm going to throw I'm just going to go over a few things that are new as of today. Um, one thing is when you're in Cloud Now and you fire it up, you can do slashmodel. You can see what model you're running on. I'm on default, which happens to be Sonnet. We can jump over to Opus. You can do the same thing in slashconfig. Switch it here. So that's new. Make sure you're running the model that works for you. There's another thing that's new about these models which is you can say something like um can you figure out what's in this project? And for a long time for a while we've had this like think hard or extended thinking. Now this is great but with our past models the we wouldn't let our model think between tool calls and that's probably when the thinking matters most. So starting with cloud 4 they can now our models now think between tool calls and we can watch this happen. So we have Claude in this project. There's a few different files in here and I'm just going to tell it to think hard and figure out what's in this project and we can watch Claude start to work. And so the way you know you triggered thinking is you'll see kind of this lighter gray text and then it'll call some file, it'll call some tools, it'll read some stuff, and then we see some more thinking. And this is awesome. Um, so I encourage you when you're working on tasks and solving bugs, throw a think hard in there. And then the other thing, and you know what, we'll just throw it up real quick, is I have this in VS Code, but of course this is in Jet Brains as well, but we have these new great integrations with VS Code and and Jet Brains. Um, we can do things like Claude's going to know what file I'm in. What file am I in? That is not what I meant to say, but Claude's going to figure it out. And you can do things like this.

话虽如此，我将切换到我的电脑，因为还有一个最佳实践，那就是**始终关注所有新功能**。我们的迭代速度非常快，我将快速介绍一些今天刚上线的、新的东西。一件事是，当你现在启动 Claude 时，你可以输入 `/model` 命令，查看你正在运行的模型。我用的是默认的 Sonnet，我们也可以切换到 Opus。你也可以在 `/config` 命令中切换。所以，确保你运行的是适合你的模型。关于这些模型，还有一点新的，就是你可以说：“你能搞清楚这个项目里有什么吗？” 很长一段时间以来，我们都有“努力思考（think hard）”或扩展思考的功能。这很棒，但对于我们过去模型，我们不允许模型在两次工具调用之间进行思考，而这可能正是思考最重要的时候。所以从 **Claude 3** 模型开始，我们的模型现在可以在工具调用之间进行思考了，我们可以看到这个过程。我们在这个项目里有 Claude，这里有几个不同的文件，我将告诉它“努力思考”，并找出这个项目的内容，我们可以看到 Claude 开始工作。你知道它触发了思考的方式是，你会看到这种浅灰色的文本，然后它会调用一些工具，读取一些东西，然后我们看到更多的思考过程。这太棒了。所以我鼓励你们在处理任务和解决 bug 时，加上“努力思考”。另一件事，我们快速展示一下，我这里是在 **VS Code** 里，当然 **JetBrains** 里也有，我们有了这些与 VS Code 和 JetBrains 的很棒的新集成。比如，Claude 会知道我当前在哪个文件里。

So these are the sort of things I would encourage you to stay on top of. We have a public uh kind of GitHub project called Claude Code under Enthropic. You can post issues there, but we also post our change log there. And so I check this once a week and make sure that I'm on top of all the new stuff we're shipping because even I can't keep up with it. So, with that said, we have like four minutes left. I'm happy to answer questions about anything cloud code related. We have it here. I can live demo some stuff if you're interested. Um, let's do a few.

这些就是我鼓励大家持续关注的事情。我们在 Anthropic 组织下有一个名为 Claude Code 的公开 GitHub 项目。你可以在那里提交问题，但我们也在那里发布我们的更新日志（change log）。我每周都会检查一次，确保我了解我们发布的所有新功能，因为连我自己都跟不上。好了，我们还有大概四分钟，我很乐意回答任何与 Claude Code 相关的问题。我可以在这里现场演示一些东西，如果你们感兴趣的话。

## 问答环节

**提问者**: Thanks. Real quick, this might be obvious, but multiple cloud MD files in a project. I presume that's possible and it just figures it out or no?

**提问者**: 谢谢。快速问一下，这可能很明显，一个项目里可以有多个 `claude.md` 文件吗？我猜是可以的，它会自动识别，对吗？

**Cal**: So, there's a few options, of course, like in the same directory. You couldn't um but you could have one here and one in a subdirectory. And I think we changed this so that all the subdirectory ones aren't read in because like Anthropic, we have a monor repo and people would open it at the top and blow up their context with all the claud MDs. So, we encourage Claude when it's searching around and it discovers claw.md files in um child directories that are relevant to be sure to read them. But by default, it just reads the cloud MD file in the current working directory when you fire it up. And then also you can set one in like your home directory. Um there are things you can do though. We have this new thing like in your cloud MD you can start referencing other files. So you could for instance um do something like this with an at sign um if you have other cloud MD files that you just kind of know you always want to read in um to do something like that.

**Cal**: 当然，在同一个目录里是不行的。但是你可以在当前目录放一个，在子目录放一个。我想我们修改了这一点，所以它不会读取所有子目录的文件，因为像在 Anthropic，我们有一个**单一代码库**（monorepo），人们会在顶层目录打开它，然后所有的 `claude.md` 文件会撑爆他们的上下文。所以，我们鼓励 Claude 在搜索时，如果发现在相关的子目录中有 `claude.md` 文件，要去读取它们。但默认情况下，当你启动它时，它只读取当前工作目录下的 `claude.md` 文件。你也可以在你的主目录设置一个。不过，你也可以做一些事情。我们有一个新功能，你可以在你的 `claude.md` 文件里引用其他文件。比如，你可以用 `@` 符号来做这件事，如果你有一些其他的 `claude.md` 文件，你总是希望它能读取。

**提问者**: Hi. Okay. I um have not had luck getting Claude to respect my Claude MD. Like there's one thing particular. Yes. where I'll ask it to refactor something and then it will leave inline comments explaining the like the what of it is and it's like like something that's extremely obvious and so I'll tell it like go and remove any inline comments that describe the what of what's happening and then it will remove it and then immediately do it again and like the same pass. So do you have any strategies for dealing with that?

**提问者**: 你好。我一直没能让 Claude 尊重我的 `claude.md` 文件。特别是一件事，当我让它重构一些东西时，它会留下行内注释来解释一些非常明显的东西。然后我告诉它去移除所有描述“是什么”的行内注释，它会移除，然后在同一个步骤里马上又加回去。你有什么策略来处理这个问题吗？

**Cal**: So there's kind of two things that fix that. So that was actually kind of a model problem. There's nothing in the prompt. We have actually a lot in the prompt for 37 that said, "Whoa, do not leave comments." And despite that, the model just loves to leave comments. Um, so it doesn't surprise me that your cloud MD didn't help much either. We already did a lot I did a lot of work to try to tamp it down from what happens out of the box. So we mostly fixed that in Cloud 4. Now there might be some new weird behavior quirks, but the other thing we made better in Cloud 4 is it's just better at following instructions. Um, and we've gotten a lot of feedback from early testers that, uh, all of a sudden, whoa, my cloud MD is being followed way more closely. Um, and it might be a good chance to go look in your CloudMD and decide, do I still need this stuff? Maybe I can take some of it out. Maybe I need to add a few new things. So, moving over to the new models might be a good time to take another look at what's in there and see what you need and what maybe can go.

**Cal**: 有两件事可以解决这个问题。这实际上是一个模型问题，跟提示无关。我们在 Claude 3.5 的提示里其实已经加了很多内容，告诉它“不要留注释”。但尽管如此，模型就是喜欢留注释。所以你的 `claude.md` 没起太大作用我也不惊讶。我已经做了很多工作来抑制它的这种行为。我们在 **Claude 3 模型**中基本解决了这个问题。现在可能还有一些新的奇怪行为，但我们在 Claude 3 中改进的另一件事是，它更善于遵循指令了。我们从早期测试者那里得到了很多反馈，说他们的 `claude.md` 文件突然被更严格地遵守了。这可能是一个好机会，去看看你的 `claude.md` 文件，决定是否还需要里面的东西，也许可以去掉一些，或者添加一些新的。所以，切换到新模型可能是重新审视 `claude.md` 内容的好时机。

**提问者**: Uh, for the record, I'm trying to think of something that you might not have thought of. We're doing multi- aent execution and parallelization. Can you make it so that for four agents, say agents two and three use the context from agent one, maybe agent four uses the context from agent two at a certain point. Yeah. Um yeah, etc.

**提问者**: 我想提一个你们可能没想到的问题。我们正在做多代理执行和并行化。你能让它实现，比如对于四个代理，让代理二和三使用代理一的上下文，也许代理四在某个时间点使用代理二的上下文，等等吗？

**Cal**: That's interesting. We're trying to So, kind of like I said at the beginning, we're trying to do the simple thing that works, which is just one agent that's great at coding and does everything. Um I think we want to figure that out. Probably what's going to happen is if you wanted to do that, you would ask all your agents to probably like write to a shared markdown file or something like that so they can all kind of like check in and communicate. Um, sometimes like I'll be working with cloud.md or claude and I'll just say like, "Hey, I need you to write some stuff in like ticket.md for another developer and then I'll fire up another cloud code and I'll be like, hey, read ticket.md like another developer left this note for you. Like this is what you're going to work on." So, I would think about trying to write that state to a file and then just kind of like count on the model's ability to just like read files and make sense them um is probably the best you can do today. And maybe we'll figure out clever ways to expose that uh in the product as something more native. Cool.

**Cal**: 这很有趣。就像我一开始说的，我们正努力做简单有效的事情，也就是只有一个擅长编码并能做所有事情的代理。我想我们会研究这个问题。可能的情况是，如果你想这样做，你会让所有代理都写入一个共享的 Markdown 文件之类的东西，这样它们就可以互相沟通。有时候，我会让 Claude 把一些东西写到一个比如 `ticket.md` 的文件里，给另一个“开发者”（也就是另一个 Claude 实例）。然后我再启动另一个 Claude Code，告诉它：“嘿，去读 `ticket.md`，另一个开发者给你留了条信息，这是你要做的工作。” 所以，我会考虑尝试将状态写入文件，然后依赖模型读取和理解文件的能力，这可能是你今天能做的最好的方法。也许未来我们会想出更聪明的方法，在产品中以更原生的方式实现这个功能。

## 结束语

All right. And with that said, I have some rare clawed code stickers that I found in my backpack. So, come find me. I'll be hanging out over there or something. Um, happy to share them. Thank you. [Applause]

好的。话虽如此，我在背包里找到了一些稀有的 Claude Code 贴纸。所以，来找我吧，我会在那边待一会儿。很乐意分享给大家。谢谢。 [掌声]
